(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{2989:(e,t,n)=>{Promise.resolve().then(n.bind(n,19))},6046:(e,t,n)=>{"use strict";var a=n(6658);n.o(a,"useParams")&&n.d(t,{useParams:function(){return a.useParams}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})},19:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var a=n(5155),s=n(2115),o=n(6046),c=n(4595),r=n(1038),i=n.n(r);function u(){var e,t,n;let r=(0,o.useRouter)(),u=(0,o.useParams)(),[d,l]=(0,s.useState)(null),[h,p]=(0,s.useState)(!0),[_,f]=(0,s.useState)({status:"none"}),[m,g]=(0,s.useState)(!1),[j,x]=(0,s.useState)(""),[v,b]=(0,s.useState)("info"),[C,N]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let e=c.j.currentUser;if(!e){r.push("/login");return}try{if(!(await fetch("http://localhost:5000/api/health")).ok)throw Error("Backend server not available")}catch(e){console.error("Backend health check failed:",e),N("Server connection failed. Please try again later."),p(!1);return}try{let t=await fetch("http://localhost:5000/api/auth/user/".concat(u.id));if(!t.ok)throw Error("Failed to fetch profile: ".concat(t.statusText));let n=await t.json();l(n.user);let a=await fetch("http://localhost:5000/api/connections/status/".concat(e.uid,"/").concat(u.id));if(!a.ok)throw Error("Failed to fetch connection status: ".concat(a.statusText));let s=await a.json();f(s)}catch(e){console.error("Data fetching error:",e),N(e instanceof Error?e.message:"An unexpected error occurred")}p(!1)}catch(e){console.error("General error:",e),N("An unexpected error occurred"),p(!1)}})()},[u.id,r]);let y=async()=>{try{let e=c.j.currentUser;if(!e){r.push("/login");return}let t=await fetch("http://localhost:5000/api/connections/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromUserId:e.uid,toUserId:u.id})});if(!t.ok)throw Error("Failed to send connection request");await t.json(),f({status:"pending",initiator:e.uid}),x("Connection request sent!"),b("info"),g(!0),setTimeout(()=>g(!1),3e3)}catch(e){console.error("Error:",e),N("Failed to send connection request")}},B=async()=>{try{let e=c.j.currentUser;if(!e){r.push("/login");return}if(!(await fetch("http://localhost:5000/api/connections/accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromUserId:_.initiator,toUserId:e.uid})})).ok)throw Error("Failed to accept connection");f({status:"accepted"}),x("Connection accepted!"),b("success"),g(!0),setTimeout(()=>g(!1),3e3)}catch(e){console.error("Error:",e),N("Failed to accept connection")}},S=async()=>{try{let e=c.j.currentUser;if(!e){r.push("/login");return}if(!(await fetch("http://localhost:5000/api/connections/".concat(e.uid,"/").concat(u.id),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to disconnect");f({status:"none"}),x("Disconnected successfully"),b("info"),g(!0),setTimeout(()=>g(!1),3e3)}catch(e){console.error("Error:",e),N("Failed to disconnect")}};if(h)return(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsx)("div",{className:i().overlay}),(0,a.jsx)("div",{className:"text-white text-center",children:"Loading..."})]});if(!d)return(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsx)("div",{className:i().overlay}),(0,a.jsx)("div",{className:"text-white text-center",children:"Profile not found"})]});let k=(null===(e=c.j.currentUser)||void 0===e?void 0:e.uid)===u.id;return(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsx)("div",{className:i().overlay}),(0,a.jsx)("header",{className:i().header,children:(0,a.jsx)("button",{onClick:()=>r.back(),className:i().backButton,children:"← Back"})}),(0,a.jsxs)("main",{className:i().profileCard,children:[(0,a.jsx)("h1",{className:i().name,children:d.name}),(0,a.jsx)("div",{className:i().interestsContainer,children:d.interests.map(e=>(0,a.jsx)("span",{className:i().interest,children:e},e))}),!k&&(0,a.jsxs)(a.Fragment,{children:["none"===_.status&&(0,a.jsx)("button",{onClick:y,className:i().connectButton,children:"Connect"}),"pending"===_.status&&_.initiator===(null===(t=c.j.currentUser)||void 0===t?void 0:t.uid)&&(0,a.jsx)("div",{className:i().statusPending,children:"Connection Request Pending"}),"pending"===_.status&&_.initiator!==(null===(n=c.j.currentUser)||void 0===n?void 0:n.uid)&&(0,a.jsx)("button",{onClick:B,className:"".concat(i().button," ").concat(i().acceptButton),children:"Accept Connection"}),"accepted"===_.status&&(0,a.jsxs)("div",{className:i().connectionActions,children:[(0,a.jsx)("div",{className:i().statusConnected,children:"Connected"}),(0,a.jsxs)("div",{className:i().actionButtons,children:[(0,a.jsx)("button",{onClick:()=>r.push("/chat/".concat(d.firebaseUid)),className:i().chatButton,children:"Start Chat"}),(0,a.jsx)("button",{onClick:S,className:i().disconnectButton,children:"Disconnect"})]})]})]})]}),m&&(0,a.jsx)("div",{className:"".concat(i().toast," ").concat(i()["toast".concat(v)]),children:j})]})}},4595:(e,t,n)=>{"use strict";n.d(t,{j:()=>c});var a=n(9904),s=n(4565);let o=(0,a.Wp)({apiKey:"AIzaSyD72HmBTrehu6RqAwfH14n37nbgSoSiF4c",authDomain:"brewnet-dd55e.firebaseapp.com",projectId:"brewnet-dd55e",storageBucket:"brewnet-dd55e.firebasestorage.app",messagingSenderId:"720864557324",appId:"1:720864557324:web:b7f4b2419dc12753503129"}),c=(0,s.xI)(o)},1038:e=>{e.exports={container:"page_container__lq__b",overlay:"page_overlay__GsRBK",header:"page_header__3hq8C",backButton:"page_backButton__8bs7n",profileCard:"page_profileCard__5iCoe",fadeIn:"page_fadeIn__hIaK0",name:"page_name__6aKxq",interestsContainer:"page_interestsContainer__xmHuk",interest:"page_interest__mEjrl",connectButton:"page_connectButton__PyFmn",pendingButton:"page_pendingButton__RKRu7",chatButton:"page_chatButton__z2m5U",connectionSection:"page_connectionSection__9Xj_S",statusPending:"page_statusPending__7ieZe",pulse:"page_pulse__2OOAP",statusConnected:"page_statusConnected__SDG8y",toast:"page_toast__L7Yr_",slideUp:"page_slideUp__SWHD0",toastinfo:"page_toastinfo__QLrCz",toastsuccess:"page_toastsuccess__h5HR6",button:"page_button__aubGT",acceptButton:"page_acceptButton__C7qHX",connectionActions:"page_connectionActions__Nl_RC",actionButtons:"page_actionButtons__qdTl0",disconnectButton:"page_disconnectButton__VXvtS"}}},e=>{var t=t=>e(e.s=t);e.O(0,[553,895,803,441,517,358],()=>t(2989)),_N_E=e.O()}]);