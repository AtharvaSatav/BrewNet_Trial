(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{1226:()=>{},6397:(e,t,i)=>{Promise.resolve().then(i.bind(i,4036))},6046:(e,t,i)=>{"use strict";var n=i(6658);i.o(n,"useParams")&&i.d(t,{useParams:function(){return n.useParams}}),i.o(n,"useRouter")&&i.d(t,{useRouter:function(){return n.useRouter}}),i.o(n,"useSearchParams")&&i.d(t,{useSearchParams:function(){return n.useSearchParams}})},4036:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>_});var n=i(5155),a=i(2115),o=i(6046),s=i(4595),r=i(4565),c=i(7650),l=i(1613);function d(){let e=document.getElementById("notifications-portal");return e?(0,c.createPortal)((0,n.jsx)(l.default,{}),e):null}var u=i(5965),f=i.n(u);function _(){let e=(0,o.useRouter)(),[t,i]=(0,a.useState)(!0),[c,l]=(0,a.useState)([]),[u,_]=(0,a.useState)(null),[m,p]=(0,a.useState)(!1),[h,N]=(0,a.useState)(null);(0,a.useEffect)(()=>{let t=s.j.onAuthStateChanged(async t=>{if(t){N(t);try{let e=await fetch("".concat("https://brewnet-api.fly.dev","/api/auth/users"));if(e.ok){let i=(await e.json()).users.filter(e=>e.firebaseUid!==t.uid);l(i)}else throw Error("Failed to fetch profiles")}catch(e){console.error("Error fetching profiles:",e),_("Failed to load profiles")}finally{i(!1)}}else e.push("/login")});return()=>t()},[e]);let g=async()=>{try{var t;let i=null===(t=s.j.currentUser)||void 0===t?void 0:t.uid;if(!i)return;if(!(await fetch("http://localhost:5000/api/auth/sign-out",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i})})).ok)throw Error("Failed to update sign-out status");await (0,r.CI)(s.j),localStorage.clear(),e.push("/login")}catch(e){console.error("Error signing out:",e),_("Failed to sign out")}};return t?(0,n.jsxs)("div",{className:f().container,children:[(0,n.jsx)("div",{className:f().overlay}),(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)("div",{className:"text-white",children:"Loading profiles..."})})]}):(0,n.jsxs)("div",{className:f().container,children:[(0,n.jsx)("div",{className:f().overlay}),(0,n.jsxs)("header",{className:f().header,children:[(0,n.jsx)("div",{className:f().brandName,children:"BrewNet"}),(0,n.jsxs)("div",{className:f().profileMenu,children:[(0,n.jsx)("button",{className:f().profileButton,onClick:()=>p(!m),children:"My Profile"}),m&&(0,n.jsxs)("div",{className:f().menuDropdown,children:[(0,n.jsx)("div",{className:f().menuItem,onClick:()=>e.push("/profile/".concat(null==h?void 0:h.uid)),children:"View Profile"}),(0,n.jsx)("div",{className:f().menuItem,onClick:()=>e.push("/onboarding?update=true"),children:"Edit Profile"}),(0,n.jsx)("div",{className:"".concat(f().menuItem," ").concat(f().signOutButton),onClick:g,children:"Sign Out"})]})]})]}),(0,n.jsxs)("main",{className:f().mainContent,children:[(0,n.jsx)("h1",{className:f().title,children:"Discover People"}),(0,n.jsx)("p",{className:f().subtitle,children:"Connect with people who share your interests"}),u&&(0,n.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),(0,n.jsx)("div",{className:f().grid,children:c.map(t=>(0,n.jsxs)("div",{className:f().card,children:[(0,n.jsx)("h2",{className:f().cardName,children:t.name}),(0,n.jsx)("div",{className:f().interestsContainer,children:t.interests.map(e=>(0,n.jsx)("span",{className:f().interest,children:e},e))}),(0,n.jsx)("button",{onClick:()=>e.push("/profile/".concat(t.firebaseUid)),className:f().viewButton,children:"View Profile"})]},t.firebaseUid))}),0===c.length&&(0,n.jsx)("div",{className:"text-center text-white py-12",children:"No other users found at the moment."})]}),(0,n.jsx)(d,{})]})}},1613:(e,t,i)=>{"use strict";i.d(t,{default:()=>d});var n=i(5155),a=i(2115),o=i(4595),s=i(2666),r=i.n(s),c=i(1319),l=i(5521);function d(){let[e,t]=(0,a.useState)([]),i=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=o.j.currentUser;if(!e)return;let i=(0,c.Ay)("wss://brewnet-api.fly.dev");return i.on("connect",()=>{i.emit("join",{userId:e.uid})}),i.on("notification",e=>{t(t=>[e,...t])}),(async()=>{try{let i=await fetch("http://localhost:5000/api/notifications/".concat(e.uid));if(i.ok){let e=await i.json();t(e.notifications)}}catch(e){console.error("Error fetching notifications:",e)}})(),()=>{i.disconnect()}},[]);let s=async e=>{try{await fetch("http://localhost:5000/api/notifications/".concat(e._id,"/read"),{method:"PUT"}),t(t=>t.filter(t=>t._id!==e._id)),"connection_request"===e.type&&i.push("/profile/".concat(e.fromUser.firebaseUid))}catch(e){console.error("Error handling notification:",e)}};return(0,n.jsx)("div",{className:r().notificationContainer,children:e.map(e=>(0,n.jsxs)("div",{className:r().notification,onClick:()=>s(e),children:["connection_request"===e.type&&(0,n.jsxs)("div",{className:r().notificationContent,children:[(0,n.jsx)("div",{className:r().notificationTitle,children:"New Connection Request!"}),(0,n.jsxs)("div",{className:r().notificationMessage,children:[e.fromUser.name," wants to connect with you"]}),(0,n.jsx)("div",{className:r().notificationTime,children:new Date(e.createdAt).toLocaleTimeString()})]}),"connection_accepted"===e.type&&(0,n.jsxs)("div",{className:r().notificationContent,children:[(0,n.jsx)("div",{className:r().notificationTitle,children:"Connection Accepted! \uD83C\uDF89"}),(0,n.jsxs)("div",{className:r().notificationMessage,children:["You are now connected with ",e.fromUser.name]}),(0,n.jsx)("div",{className:r().notificationTime,children:new Date(e.createdAt).toLocaleTimeString()})]})]},e._id))})}},4595:(e,t,i)=>{"use strict";i.d(t,{j:()=>s});var n=i(9904),a=i(4565);let o=(0,n.Wp)({apiKey:"AIzaSyD72HmBTrehu6RqAwfH14n37nbgSoSiF4c",authDomain:"brewnet-dd55e.firebaseapp.com",projectId:"brewnet-dd55e",storageBucket:"brewnet-dd55e.firebasestorage.app",messagingSenderId:"720864557324",appId:"1:720864557324:web:b7f4b2419dc12753503129"}),s=(0,a.xI)(o)},5965:e=>{e.exports={container:"page_container__cRG_4",overlay:"page_overlay__Jaxqz",header:"page_header__NSz7e",brandName:"page_brandName__ishNN",mainContent:"page_mainContent__Qmfub",title:"page_title__te_dE",subtitle:"page_subtitle__0cBxp",grid:"page_grid___ptBk",card:"page_card__bScfy",cardName:"page_cardName__SoP60",interestsContainer:"page_interestsContainer__clSzx",interest:"page_interest__2Cq2p",viewButton:"page_viewButton__ziz7z",updateProfileButton:"page_updateProfileButton__4Fipb",profileMenu:"page_profileMenu__o20bY",profileButton:"page_profileButton___Xkjd",menuDropdown:"page_menuDropdown__FVgmY",menuItem:"page_menuItem__fzIpL",signOutButton:"page_signOutButton__A5Ifo"}},2666:e=>{e.exports={notificationContainer:"Notifications_notificationContainer__I9ENV",notification:"Notifications_notification__VtIyp",slideIn:"Notifications_slideIn__X02R_",notificationContent:"Notifications_notificationContent__YDr4U",notificationTitle:"Notifications_notificationTitle__W_A3e",notificationMessage:"Notifications_notificationMessage__I5nVK",notificationTime:"Notifications_notificationTime__xJYAW"}}},e=>{var t=t=>e(e.s=t);e.O(0,[33,282,895,803,671,441,517,358],()=>t(6397)),_N_E=e.O()}]);